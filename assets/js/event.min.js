function createEvent(){rowdone.hide(),$("#rowDoneby").hide(),form.dialog("option","title","Шинэ бүртгэл үүсгэх"),"USER"!==role?form.dialog({buttons:[{text:"Хадгалах",click:function(){var e={};$('input[type="text"], input[type="hidden"], select, textarea',form).each(function(){var t=$(this);e[t.attr("name")]=t.val()}),$.ajax({type:"POST",url:base_url+"/event/add",data:e,dataType:"json",success:function(e){"success"==e.status?(form.dialog("close"),$("#calendar").fullCalendar("refetchEvents"),showMessage(e.message,"success")):$("p.feedback",form).removeClass("success, notify").addClass("error").html(e.message).show()}})}},{text:"Болих",click:function(){$(this).dialog("close")}}]}):form.dialog({buttons:[{text:"Болих",click:function(){$(this).dialog("close")}}]}),form.dialog("open")}function clickEvent(e,t,a){switch(role){case"ENG":1==t&&0==a?(rowdone.show(),$("#rowDoneby").hide(),allEnabled(),form.dialog("option","title","Үйл ажиллагаа гүйцэтгэх"),form.dialog({buttons:[{text:"Гүйцэтгэх",click:function(){data=getData(e),$.ajax({url:base_url+"/event/done",data:data,type:"POST",dataType:"json",success:function(e){"success"==e.status?(form.dialog("close"),showMessage(e.message,"success"),$("#calendar").fullCalendar("refetchEvents")):$("p.feedback",form).removeClass("success, notify").addClass("error").html(e.message).show()}})}},{text:"Болих",click:function(){$(this).dialog("close")}}]})):(allDisabled(),form.dialog("option","title","Үйл ажиллагаа"),form.dialog({buttons:[{text:"Буцах",click:function(){$(this).dialog("close"),allEnabled()}}]})),form.dialog("open");break;case"ENG_CHIEF":form.dialog("option","title","Үйл ажиллагаа"),form.dialog({buttons:[{text:"Устгах",click:function(){data=getData(e),$.ajax({url:base_url+"/event/delete",data:data,type:"POST",dataType:"json",success:function(e){"success"==e.status?(form.dialog("close"),showMessage(e.message,"success"),$("#calendar").fullCalendar("refetchEvents")):$("p.feedback",form).removeClass("success, notify").addClass("error").html(e.message).show()}})}},{text:"Засах",click:function(){data=getData(e),$.ajax({url:base_url+"/event/edit",data:data,type:"POST",dataType:"json",success:function(e){"success"==e.status?(form.dialog("close"),showMessage(e.message,"success"),$("#calendar").fullCalendar("refetchEvents")):$("p.feedback",form).removeClass("success, notify").addClass("error").html(e.message).show()}})}},{text:"Болих",click:function(){form.dialog("close")}}]}),form.dialog("open");break;case"CHIEF":form.dialog("option","title","Үйл ажиллагаа"),form.dialog({buttons:[{text:"Зөвшөөрөх",click:function(){data=getData(e),$.ajax({url:base_url+"/event/authorize",data:data,type:"POST",dataType:"json",success:function(e){"success"==e.status?(form.dialog("close"),showMessage(e.message,"success"),$("#calendar").fullCalendar("refetchEvents")):$("p.feedback",form).removeClass("success, notify").addClass("error").html(e.message).show()}})}},{text:"Устгах",click:function(){data=getData(e),$.ajax({url:base_url+"/event/delete",data:data,type:"POST",dataType:"json",success:function(e){"success"==e.status?(form.dialog("close"),showMessage(e.message,"success"),$("#calendar").fullCalendar("refetchEvents")):$("p.feedback",form).removeClass("success, notify").addClass("error").html(e.message).show()}})}},{text:"Засах",click:function(){data=getData(e),$.ajax({url:base_url+"/event/edit",data:data,type:"POST",dataType:"json",success:function(e){"success"==e.status?(form.dialog("close"),showMessage(e.message,"success"),$("#calendar").fullCalendar("refetchEvents")):$("p.feedback",form).removeClass("success, notify").addClass("error").html(e.message).show()}})}},{text:"Болих",click:function(){form.dialog("close")}}]}),form.dialog("open");break;default:form.dialog("option","title","Үйл ажиллагаа"),form.dialog({buttons:[{text:"Буцах",click:function(){form.dialog("close")}}]}),form.dialog("open")}}function moveEvent(e,t,a,s){$.ajax({url:base_url+"/event/move",data:"start="+e+"&end="+t+"&id="+a+"&action="+s,type:"POST",dataType:"json",success:function(e){"success"==e.status?showMessage(e.message,"success"):showMessage(e.message,"error")}})}function allDisabled(){$('input[type="text"], input[type="hidden"], select, textarea',form).each(function(){$(this).prop("disabled","disabled")})}function allEnabled(){$('input[type="text"], input[type="hidden"], select, textarea',form).each(function(){$(this).prop("disabled",!1)})}function getData(e){var t={};return $('input[type="text"], input[type="hidden"], select, textarea',form).each(function(){var e=$(this);t[e.attr("name")]=e.val()}),t.eventId=e,t.done=$("#done").val(),t}function showMessage(e,t){$("p#notification").length||$("#nav-bar").prepend('<p id="notification"></p>');var a=$("p#notification");a.hide(),a.removeClass(),a.addClass(t),a.html(e),a.fadeIn("fast",function(){a.delay(5e3).fadeOut()})}$(document).ready(function(){form=$("#event_form"),rowdone=$("#trdone"),role=$("#role").val(),eventtypeId=$("#eventtype_id"),equipmentId=$("#equipment_id"),locationId=$("#location_id"),event=$('input[name="event"]'),done=$("#done"),form.dialog({width:480,autoOpen:!1,resizable:!1,modal:!0,close:function(){$("p.feedback",form).html("").hide(),$('input[type="text"], input[type="hidden"], textarea, select',form).val(""),$("#eventId").text("")}}),$("#startdate").datetimepicker({dateFormat:"yy-mm-dd",changeMonth:!0,showOtherMonths:!0,showWeek:!0}),$("#enddate").datetimepicker({dateFormat:"yy-mm-dd",changeMonth:!0,showOtherMonths:!0,showWeek:!0});var e=$("#calendar").fullCalendar({columnFormat:{month:"dddd",week:"ddd-d",day:""},axisFormat:"H:mm",timeFormat:{"":"H:mm",agenda:"H:mm{ - H:mm}"},buttonText:{today:"Өнөөдөр",month:"Сар",day:"Өдөр",week:"7 хоног"},monthNames:["I сар","II сар","III сар","IV сар","V сар","VI сар","VII сар","VIII сар","IX сар","X сар","XI сар","XII сар"],monthNamesShort:["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],dayNames:["Ням","Даваа","Мягмар","Лхагва","Пүрэв","Баасан","Бямба"],dayNamesShort:["Ня","Да","Мя","Лх","Пү","Ба","Бя"],header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},events:{url:base_url+"/event/getevent",cache:!0},eventColor:"#FFD900",eventTextColor:"#000000",eventborderColor:"red",selectable:!0,selectHelper:!0,editable:!0,eventDrop:function(e,t){moveEvent($.fullCalendar.formatDate(e.start,"yyyy-MM-dd HH:mm:ss"),$.fullCalendar.formatDate(e.end,"yyyy-MM-dd HH:mm:ss"),e.id,"move")},eventResize:function(e){start=$.fullCalendar.formatDate(e.start,"yyyy-MM-dd HH:mm:ss"),end=$.fullCalendar.formatDate(e.end,"yyyy-MM-dd HH:mm:ss"),moveEvent(start,end,e.id,"resize")},select:function(t,a,s){createEvent(),$("#createdbyId").text(""),$("#startdate").val($.fullCalendar.formatDate(t,"yyyy-MM-dd HH:mm")),$("#enddate").val($.fullCalendar.formatDate(a,"yyyy-MM-dd HH:mm")),e.fullCalendar("unselect"),$("#calendar").fullCalendar("refetchEvents")},eventClick:function(e,t,a){$.post(base_url+"/event/getOne",{id:e.id},function(t){$("#eventId").text(e.id),$("#event").val(t.event),null!==t.createdby?$("#createdbyId").text(t.createdby):$("#createdbyId").text(""),eventtypeId.val(t.eventtype_id),equipmentId.val(t.equipment_id),locationId.val(t.location_id),done.val(t.done),t.doneby?$("#doneby").text(t.doneby):$("#doneby").text(""),clickEvent(e.id,t.active,t.isdone)}),$("#rowDoneby").show(),$("#startdate").val($.fullCalendar.formatDate(e.start,"yyyy-MM-dd HH:mm")),$("#enddate").val($.fullCalendar.formatDate(e.end,"yyyy-MM-dd HH:mm")),$(this).css("border-color","red")}})});