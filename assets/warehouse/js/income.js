function inc_action(i,e,n){action_str="<div title='Дэлгэрэнгүй' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit'><span id='log_none' onclick='init_view("+e.rowId+")' class='ui-icon ui-icon-extlink'></span></div></div>";$("#action").serializeArray();return $("input.action").each(function(){switch($(this).val()){case"delete":action_str=action_str+"<div title='Устгах' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit'><span onclick='delete_expense("+e.rowId+")' target ="+e.invoice_id+" class='ui-icon ui-icon-trash'></span></div></div>"}}),action_str}function invoiceDel(i){1==confirm("Та, энэ орлогийг устгахдаа итгэлтэй байна уу!")&&window.location.assign("/ecns/warehouse/invoiceDel/"+i)}jQuery(document).ready(function(){var i=$("#grid");i.jqGrid({url:"/ecns/wm_ajax/income",datatype:"xml",mtype:"GET",colNames:["Орлогын №","Огноо","Гүйлгээний утга","Нийлүүлэгч","Нягтлан","Нярав","Эхний үлдэгдэл","Үйлдэл"],colModel:[{name:"income_no",index:"income_no",width:20,align:"right"},{name:"income_date",index:"income_date",width:25,align:"right"},{name:"purpose",index:"purpose",width:120},{name:"supplier",index:"supplier",width:40},{name:"accountant",index:"accountant",width:30},{name:"storeman",index:"storeman",width:30},{name:"isbalance",index:"isbeginbalance",width:30,align:"right"},{name:"action",width:30,index:"action",align:"right",formatter:inc_action}],pager:jQuery("#pager"),rowNum:15,rowList:[15,20,30],sortname:"invoice_id",sortorder:"desc",viewrecords:!0,caption:"Орлого бүртгэл",autowidth:!0,height:400,width:"100%",subGrid:!0,subGridRowExpanded:function(i,e){var n;n=i+"_t",jQuery("#"+i).html("<table id='"+n+"' class='scroll'></table>"),jQuery("#"+n).jqGrid({autoencode:!1,url:"/ecns/wm_ajax/incomeDtl?q=2&id="+e,datatype:"xml",colNames:["#","Сэлбэг, материал","Хэмжих нэгж","Тоо/ш","Үйлдэл"],colModel:[{name:"id",index:"id",width:80,key:!0,align:"right"},{name:"spare",index:"spare",width:200},{name:"measure",index:"measure",width:100,align:"right"},{name:"qty",index:"qty",width:80,align:"right"},{name:"action",index:"action",align:"right"}],height:"100%",width:600,rowNum:20,sortname:"num",sortorder:"asc"})}}).navGrid("#pager",{edit:!1,add:!1,del:!1,search:!0}),$("#search").click(function(){var e=$("#spare_id").val(),n=$("#spare").val();0==e&&(n=!0)?alert("Ийм сэлбэг байхгүй байна!"):((null==n||""==n)&0!=e&&(e=0),i.jqGrid("setGridParam",{url:"/ecns/wm_ajax/income?spare_id="+e,page:1}).trigger("reloadGrid"))})});