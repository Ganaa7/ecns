"use strict";(function ExtensionRouterClosure(){var e=chrome.extension.getURL("content/web/viewer.html");var c=chrome.extension.getURL("/");var a=["http","https","ftp","file","chrome-extension","filesystem","drive"];function d(i){i=i.substring(c.length);var g=i.search(/:|%3A/i);if(g===-1){return}var h=i.slice(0,g).toLowerCase();if(a.indexOf(h)>=0){i=i.split("#")[0];if(i.charAt(g)===":"){i=encodeURIComponent(i)}return i}}function f(g){if(g.lastIndexOf(e,0)!==0){return}g=g.match(/[&?]file=([^&#]+)/);if(g){g=g[1];return g}}function b(h,i){var g=d(i)||f(i);if(g){chrome.pageAction.setPopup({tabId:h,popup:"pageActionPopup.html?file="+g});chrome.pageAction.show(h)}else{console.log("Unable to get PDF url from "+i)}}chrome.webRequest.onBeforeRequest.addListener(function(h){var g=d(h.url);if(g){g=e+"?file="+g;console.log("Redirecting "+h.url+" to "+g);return{redirectUrl:g}}},{types:["main_frame","sub_frame"],urls:a.map(function(g){return c+g+"*"})},["blocking"]);chrome.runtime.onMessage.addListener(function(h,g){if(h==="showPageAction"&&g.tab){b(g.tab.id,g.tab.url)}});chrome.tabs.query({url:c+"*:*"},function(h){for(var g=0;g<h.length;++g){chrome.tabs.reload(h[g].id)}});console.log("Set up extension URL router.")})();