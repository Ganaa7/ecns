"use strict";var ARCFourCipher=(function ARCFourCipherClosure(){function a(g){this.a=0;this.b=0;var h=new Uint8Array(256);var f,d=0,e,c=g.length;for(f=0;f<256;++f){h[f]=f}for(f=0;f<256;++f){e=h[f];d=(d+e+g[f%c])&255;h[f]=h[d];h[d]=e}this.s=h}a.prototype={encryptBlock:function b(f){var g,d=f.length,h,e;var k=this.a,j=this.b,l=this.s;var c=new Uint8Array(d);for(g=0;g<d;++g){k=(k+1)&255;h=l[k];j=(j+h)&255;e=l[j];l[k]=e;l[j]=h;c[g]=f[g]^l[(h+e)&255]}this.a=k;this.b=j;return c}};a.prototype.decryptBlock=a.prototype.encryptBlock;return a})();var calculateMD5=(function calculateMD5Closure(){var b=new Uint8Array([7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21]);var a=new Int32Array([-680876936,-389564586,606105819,-1044525330,-176418897,1200080426,-1473231341,-45705983,1770035416,-1958414417,-42063,-1990404162,1804603682,-40341101,-1502002290,1236535329,-165796510,-1069501632,643717713,-373897302,-701558691,38016083,-660478335,-405537848,568446438,-1019803690,-187363961,1163531501,-1444681467,-51403784,1735328473,-1926607734,-378558,-2022574463,1839030562,-35309556,-1530992060,1272893353,-155497632,-1094730640,681279174,-358537222,-722521979,76029189,-640364487,-421815835,530742520,-995338651,-198630844,1126891415,-1416354905,-57434055,1700485571,-1894986606,-1051523,-2054922799,1873313359,-30611744,-1560198380,1309151649,-145523070,-1120210379,718787259,-343485551]);function c(F,l,k){var r=1732584193,q=-271733879,p=-1732584194,o=271733878;var e=(k+72)&~63;var h=new Uint8Array(e);var x,u,t;for(x=0;x<k;++x){h[x]=F[l++]}h[x++]=128;t=e-8;while(x<t){h[x++]=0}h[x++]=(k<<3)&255;h[x++]=(k>>5)&255;h[x++]=(k>>13)&255;h[x++]=(k>>21)&255;h[x++]=(k>>>29)&255;h[x++]=0;h[x++]=0;h[x++]=0;var s=new Int32Array(16);for(x=0;x<e;){for(u=0;u<16;++u,x+=4){s[u]=(h[x]|(h[x+1]<<8)|(h[x+2]<<16)|(h[x+3]<<24))}var E=r,D=q,C=p,A=o,z,y;for(u=0;u<64;++u){if(u<16){z=(D&C)|((~D)&A);y=u}else{if(u<32){z=(A&D)|((~A)&C);y=(5*u+1)&15}else{if(u<48){z=D^C^A;y=(3*u+5)&15}else{z=C^(D|(~A));y=(7*u)&15}}}var B=A,m=(E+z+a[u]+s[y])|0,v=b[u];A=C;C=D;D=(D+((m<<v)|(m>>>(32-v))))|0;E=B}r=(r+E)|0;q=(q+D)|0;p=(p+C)|0;o=(o+A)|0}return new Uint8Array([r&255,(r>>8)&255,(r>>16)&255,(r>>>24)&255,q&255,(q>>8)&255,(q>>16)&255,(q>>>24)&255,p&255,(p>>8)&255,(p>>16)&255,(p>>>24)&255,o&255,(o>>8)&255,(o>>16)&255,(o>>>24)&255])}return c})();var NullCipher=(function NullCipherClosure(){function a(){}a.prototype={decryptBlock:function b(c){return c}};return a})();var AES128Cipher=(function AES128CipherClosure(){var b=new Uint8Array([141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141]);var i=new Uint8Array([99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]);var e=new Uint8Array([82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125]);var h=new Uint32Array([0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795]);function g(t){var s=176,u=new Uint8Array(s);u.set(t);for(var m=16,o=1;m<s;++o){var r=u[m-3],q=u[m-2],p=u[m-1],l=u[m-4];r=i[r];q=i[q];p=i[p];l=i[l];r=r^b[o];for(var k=0;k<4;++k){u[m]=(r^=u[m-16]);m++;u[m]=(q^=u[m-16]);m++;u[m]=(p^=u[m-16]);m++;u[m]=(l^=u[m-16]);m++}}return u}function c(q,x){var l=new Uint8Array(16);l.set(q);var o,n,m;var A,z,w;for(n=0,m=160;n<16;++n,++m){l[n]^=x[m]}for(o=9;o>=1;--o){A=l[13];l[13]=l[9];l[9]=l[5];l[5]=l[1];l[1]=A;A=l[14];z=l[10];l[14]=l[6];l[10]=l[2];l[6]=A;l[2]=z;A=l[15];z=l[11];w=l[7];l[15]=l[3];l[11]=A;l[7]=z;l[3]=w;for(n=0;n<16;++n){l[n]=e[l[n]]}for(n=0,m=o*16;n<16;++n,++m){l[n]^=x[m]}for(n=0;n<16;n+=4){var y=h[l[n]],s=h[l[n+1]],r=h[l[n+2]],p=h[l[n+3]];A=(y^(s>>>8)^(s<<24)^(r>>>16)^(r<<16)^(p>>>24)^(p<<8));l[n]=(A>>>24)&255;l[n+1]=(A>>16)&255;l[n+2]=(A>>8)&255;l[n+3]=A&255}}A=l[13];l[13]=l[9];l[9]=l[5];l[5]=l[1];l[1]=A;A=l[14];z=l[10];l[14]=l[6];l[10]=l[2];l[6]=A;l[2]=z;A=l[15];z=l[11];w=l[7];l[15]=l[3];l[11]=A;l[7]=z;l[3]=w;for(n=0;n<16;++n){l[n]=e[l[n]];l[n]^=x[n]}return l}function d(j){this.key=g(j);this.buffer=new Uint8Array(16);this.bufferPosition=0}function f(q,t){var r,o,w,s=q.length,p=this.buffer,k=this.bufferPosition,x=[],n=this.iv;for(r=0;r<s;++r){p[k]=q[r];++k;if(k<16){continue}var u=c(p,this.key);for(o=0;o<16;++o){u[o]^=n[o]}n=p;x.push(u);p=new Uint8Array(16);k=0}this.buffer=p;this.bufferLength=k;this.iv=n;if(x.length===0){return new Uint8Array([])}var v=16*x.length;if(t){var m=x[x.length-1];v-=m[15];x[x.length-1]=m.subarray(0,16-m[15])}var l=new Uint8Array(v);for(r=0,o=0,w=x.length;r<w;++r,o+=16){l.set(x[r],o)}return l}d.prototype={decryptBlock:function a(n,o){var l,k=n.length;var j=this.buffer,m=this.bufferPosition;for(l=0;m<16&&l<k;++l,++m){j[m]=n[l]}if(m<16){this.bufferLength=m;return new Uint8Array([])}this.iv=j;this.buffer=new Uint8Array(16);this.bufferLength=0;this.decryptBlock=f;return this.decryptBlock(n.subarray(16),o)}};return d})();var CipherTransform=(function CipherTransformClosure(){function c(e,d){this.stringCipherConstructor=e;this.streamCipherConstructor=d}c.prototype={createStream:function b(f,e){var d=new this.streamCipherConstructor();return new DecryptStream(f,e,function g(h,i){return d.decryptBlock(h,i)})},decryptString:function a(e){var d=new this.stringCipherConstructor();var f=stringToBytes(e);f=d.decryptBlock(f,true);return bytesToString(f)}};return c})();var CipherTransformFactory=(function CipherTransformFactoryClosure(){var c=new Uint8Array([40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122]);function h(F,m,w,q,r,v,B,E){var t=40+w.length+F.length;var y=new Uint8Array(t),D=0,C,x;if(m){x=Math.min(32,m.length);for(;D<x;++D){y[D]=m[D]}}C=0;while(D<32){y[D++]=c[C++]}for(C=0,x=w.length;C<x;++C){y[D++]=w[C]}y[D++]=r&255;y[D++]=(r>>8)&255;y[D++]=(r>>16)&255;y[D++]=(r>>>24)&255;for(C=0,x=F.length;C<x;++C){y[D++]=F[C]}if(v>=4&&!E){y[D++]=255;y[D++]=255;y[D++]=255;y[D++]=255}var o=calculateMD5(y,0,D);var s=B>>3;if(v>=3){for(C=0;C<50;++C){o=calculateMD5(o,0,s)}}var A=o.subarray(0,s);var l,u;if(v>=3){for(D=0;D<32;++D){y[D]=c[D]}for(C=0,x=F.length;C<x;++C){y[D++]=F[C]}l=new ARCFourCipher(A);var u=l.encryptBlock(calculateMD5(y,0,D));x=A.length;var p=new Uint8Array(x),z;for(C=1;C<=19;++C){for(z=0;z<x;++z){p[z]=A[z]^C}l=new ARCFourCipher(p);u=l.encryptBlock(u)}for(C=0,x=u.length;C<x;++C){if(q[C]!=u[C]){return null}}}else{l=new ARCFourCipher(A);u=l.encryptBlock(c);for(C=0,x=u.length;C<x;++C){if(q[C]!=u[C]){return null}}}return A}function b(x,m,v,z){var l=new Uint8Array(32),s=0,q,o;o=Math.min(32,x.length);for(;s<o;++s){l[s]=x[s]}q=0;while(s<32){l[s++]=c[q++]}var r=calculateMD5(l,0,s);var w=z>>3;if(v>=3){for(q=0;q<50;++q){r=calculateMD5(r,0,r.length)}}var u,y;if(v>=3){y=m;var t=new Uint8Array(w),p;for(q=19;q>=0;q--){for(p=0;p<w;++p){t[p]=r[p]^q}u=new ARCFourCipher(t);y=u.encryptBlock(y)}}else{u=new ARCFourCipher(r.subarray(0,w));y=u.encryptBlock(m)}return y}var g=Name.get("Identity");function e(n,m,t){var j=n.get("Filter");if(!isName(j)||j.name!="Standard"){error("unknown encryption method")}this.dict=n;var q=n.get("V");if(!isInt(q)||(q!=1&&q!=2&&q!=4)){error("unsupported encryption algorithm")}this.algorithm=q;var w=n.get("Length")||40;if(!isInt(w)||w<40||(w%8)!==0){error("invalid key length")}var k=stringToBytes(n.get("O")).subarray(0,32);var v=stringToBytes(n.get("U")).subarray(0,32);var l=n.get("P");var r=n.get("R");var o=(q==4&&n.get("EncryptMetadata")!==false);this.encryptMetadata=o;var i=stringToBytes(m);var p;if(t){p=stringToBytes(t)}var s=h(i,p,k,v,l,r,w,o);if(!s&&!t){throw new PasswordException("No password given",PasswordResponses.NEED_PASSWORD)}else{if(!s&&t){var u=b(p,k,r,w);s=h(i,u,k,v,l,r,w,o)}}if(!s){throw new PasswordException("Incorrect Password",PasswordResponses.INCORRECT_PASSWORD)}this.encryptionKey=s;if(q==4){this.cf=n.get("CF");this.stmf=n.get("StmF")||g;this.strf=n.get("StrF")||g;this.eff=n.get("EFF")||this.strf}}function a(k,p,r,j){var m=new Uint8Array(r.length+9),l,q;for(l=0,q=r.length;l<q;++l){m[l]=r[l]}m[l++]=k&255;m[l++]=(k>>8)&255;m[l++]=(k>>16)&255;m[l++]=p&255;m[l++]=(p>>8)&255;if(j){m[l++]=115;m[l++]=65;m[l++]=108;m[l++]=84}var o=calculateMD5(m,0,l);return o.subarray(0,Math.min(r.length+5,16))}function f(j,i,o,n,r){var m=j.get(i.name);var l;if(m!==null&&m!==undefined){l=m.get("CFM")}if(!l||l.name=="None"){return function p(){return new NullCipher()}}if("V2"==l.name){return function k(){return new ARCFourCipher(a(o,n,r,false))}}if("AESV2"==l.name){return function q(){return new AES128Cipher(a(o,n,r,true))}}error("Unknown crypto method")}e.prototype={createCipherTransform:function d(i,m){if(this.algorithm==4){return new CipherTransform(f(this.cf,this.stmf,i,m,this.encryptionKey),f(this.cf,this.strf,i,m,this.encryptionKey))}var k=a(i,m,this.encryptionKey,false);var j=function l(){return new ARCFourCipher(k)};return new CipherTransform(j,j)}};return e})();